# RRF算法（Reciprocal Rank Fusion）

RRF（Reciprocal Rank Fusion，倒数排名融合）是一种用于信息检索和推荐系统中的排序融合算法。它由Carmel等人在2009年提出，主要用于合并来自多个不同检索系统或排序列表的结果。

## 基本原理

RRF算法的核心思想是：
- 对于每个文档在各个排序列表中的位置，计算其"倒数排名"
- 将这些倒数排名相加，得到一个融合后的综合分数
- 根据综合分数对所有文档重新排序

## 数学公式

RRF的计算公式为：

```
score(d) = Σ [1/(k + rank(q_i, d))]
```

其中：
- `d` 是待评估的文档
- `q_i` 是第i个查询或排序列表
- `rank(q_i, d)` 是文档d在第i个排序列表中的排名（从1开始）
- `k` 是一个常数，通常取值为60

## 为什么使用RRF

RRF算法具有以下优势：
1. **仅需排名信息**：不需要知道各个排序列表的具体评分值，只需要排名顺序
2. **对顶部结果敏感**：排名靠前的文档对最终结果影响更大
3. **无需参数调整**：相比其他融合方法，RRF通常不需要复杂的参数调整
4. **简单高效**：实现简单，计算效率高
5. **效果良好**：在多种信息检索任务中表现优异

## 应用场景

RRF广泛应用于：
- 搜索引擎结果融合
- 多模型推荐系统
- 问答系统
- 混合检索系统（结合关键词搜索和向量搜索等）

## 举例说明

假设有两个排序列表：
- 列表1：[A, B, C, D] → A排第1，B排第2，C排第3，D排第4
- 列表2：[B, A, D, C] → B排第1，A排第2，D排第3，C排第4

使用k=60计算RRF分数：
- A: 1/(60+1) + 1/(60+2) = 0.01639 + 0.01639 ≈ 0.03278
- B: 1/(60+2) + 1/(60+1) = 0.01639 + 0.01639 ≈ 0.03278
- C: 1/(60+3) + 1/(60+4) = 0.01587 + 0.01587 ≈ 0.03174
- D: 1/(60+4) + 1/(60+3) = 0.01587 + 0.01587 ≈ 0.03174

最终排序为：A=B > C=D（实际中A和B的分数会有微小差异）

RRF已成为信息检索领域中一种标准的排序融合技术，特别是在需要整合多种检索方法结果的场景中非常有效。